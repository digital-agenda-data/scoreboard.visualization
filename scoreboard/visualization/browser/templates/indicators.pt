<html metal:use-macro="here/main_template/macros/master"
  i18n:domain="plone">
  <div metal:fill-slot="main" id="indicators-content"
    tal:define="normalizeString nocall:context/@@plone/normalizeString;">
    <div class="row">
      <div class="heading-wrapper">
        <h1 class="documentFirstHeading"><span id="dataset-title" tal:content="here/getExtended_title"/></h1>
      </div>
    </div>
    <div class="main-content">
    <div class="row">
      <div class="dataset-manage bootstrap col-md-12">
        <ul class="nav nav-tabs">
          <li><a tal:attributes="href string:${portal_url}/."><span class="glyphicon glyphicon-home" aria-hidden="true"></span> Home</a></li>
          <li><a tal:attributes="href string:${here/absolute_url}/visualizations"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> Charts</a></li>
          <li><a tal:attributes="href string:${here/absolute_url}"><span class="glyphicon glyphicon-file" aria-hidden="true"></span> Dataset</a></li>
          <li class="active"><a href="#"><span class="glyphicon glyphicon-tags" aria-hidden="true"></span> Indicators</a></li>
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12 use-top-padding">
        <p id="dataset-description" tal:content="structure here/getSummary" />
        <p>The following table provides methodological information about the source, the scope and the definition of each indicator. For more details, click on the links in the table or explore the whole database.</p>
        <div id="indicators-toc" class="listing-description"> </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12 use-bottom-padding">
        <table class="list_indicators">
          <thead>
              <tr>
                  <th style="width:20%">Indicator</th>
                  <th style="width:40%">Definition and scope</th>
                  <th style="width:12%">Time coverage</th>
                  <th style="width:16%">Explore more using SPARQL queries</th>
                  <th style="width:12%">Source</th></tr>
          </thead>

          <tbody>
            <tal:row tal:repeat="row view/dataset_details">
                <tr class="groupName" tal:condition="python:row['type'] == 'header'" tal:define="indicator python:row['indicator']" tal:attributes="id python:normalizeString(indicator.get('group_name', ''))">
                    <td colspan="5" tal:define="groupName indicator/group_name|nothing">
                        <tal:block condition="groupName">
                            <span tal:replace="groupName"></span>
                        </tal:block>
                    </td>
                </tr>
                <tr tal:condition="python:row['type'] == 'row'" tal:define="indicator python:row['indicator']">
                    <td class="even" tal:define="longlabel indicator/label|nothing">
                        <tal:block condition="longlabel">
                            <span tal:replace="longlabel"></span>
                        </tal:block>
                    </td>
                    <td class="odd" tal:define="definition indicator/definition|nothing; notes indicator/note|nothing; notation indicator/notation|indicator/indicator">
                        <tal:block condition="notation">
                            <strong class="notation">Notation: </strong><span tal:replace="notation"></span>
                        </tal:block>
                        <br tal:condition="python:notation and (definition or notes)"/>
                        <tal:block condition="definition">
                            <strong class="definition">Definition: </strong><span tal:content="structure definition"></span>
                        </tal:block>
                        <br tal:condition="python:definition and notes"/>
                        <tal:block condition="notes">
                            <strong class="notes">Notes: </strong><span tal:content="structure notes"></span>
                        </tal:block>
                    </td>
                    <td class="even">
                        <span tal:replace="indicator/minYear"></span> - <span tal:replace="indicator/maxYear"></span>
                    </td>
                    <td class="odd">
                        <a target="_blank"
                          tal:attributes="href python:view.getIndicatorURLData('find_countries_query', indicator);">Find countries</a>
                        <br />
                        <a target="_blank"
                          tal:attributes="href python:view.getIndicatorURLData('find_breakdowns_query', indicator);">Find breakdowns</a>
                    </td>
                    <td class="even" tal:define="sourcelink indicator/source_url|nothing; sourcelabel indicator/source_label|nothing">
                        <a tal:condition="sourcelink" tal:attributes="href sourcelink" tal:content="sourcelabel"></a>
                        <span tal:condition="not:sourcelink" tal:replace="sourcelabel"></span>
                    </td>
                </tr>
            </tal:row>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <input type="hidden" id="dataset-value" tal:attributes="value here/dataset" />
        <div id="dataset-navigation" class="navigation-widget"></div>
      </div>
    </div>

  </div>
  </div>
</html>
